use universidad;
select apellido1, apellido2, nombre from persona where tipo = 'alumno' order by apellido1, apellido2, nombre ASC;
select apellido1, apellido2, nombre, telefono from persona where telefono is null and tipo = 'alumno';
select apellido1, apellido2, nombre, fecha_nacimiento from persona where tipo = 'alumno' and fecha_nacimiento between '1999-01-01' and '1999-12-31';
select apellido1, apellido2, nombre, telefono, nif from persona where tipo = 'profesor' and telefono is null and nif like '%K';
select asignatura.nombre, asignatura.creditos from asignatura inner join grado on asignatura.id_grado = grado.id where asignatura.cuatrimestre = 1 and asignatura.curso = 3 AND grado.id = 7;
select persona.apellido1, persona.apellido2, persona.nombre, departamento.nombre from persona inner join profesor on persona.id = profesor.id_profesor inner join departamento on profesor.id_departamento = departamento.id order by persona.apellido1, persona.apellido2, persona.nombre;
select asignatura.nombre, curso_escolar.anyo_inicio, curso_escolar.anyo_fin from alumno_se_matricula_asignatura  inner join asignatura on alumno_se_matricula_asignatura.id_asignatura = asignatura.id inner join curso_escolar on alumno_se_matricula_asignatura.id_curso_escolar = curso_escolar.id where alumno_se_matricula_asignatura.id_alumno = (select id from persona where nif = '26902806M')order by asignatura.nombre, curso_escolar.anyo_inicio, curso_escolar.anyo_fin; 
select departamento.nombre, grado.nombre, asignatura.id_profesor from departamento inner join profesor on departamento.id = profesor.id_departamento inner join asignatura on profesor.id_profesor = asignatura.id_profesor inner join grado on asignatura.id_grado = grado.id where grado.nombre = 'Grado en Ingeniería Informática (Plan 2015)';
select persona.apellido1, persona.apellido2, persona.nombre, curso_escolar.anyo_inicio, curso_escolar.anyo_fin from persona inner join alumno_se_matricula_asignatura on persona.id = alumno_se_matricula_asignatura.id_alumno inner join curso_escolar on alumno_se_matricula_asignatura.id_curso_escolar = curso_escolar.id where curso_escolar.anyo_inicio = 2018 and curso_escolar.anyo_fin = 2019 order by  persona.apellido1, persona.apellido2, persona.nombre, curso_escolar.anyo_inicio, curso_escolar.anyo_fin;
select departamento.nombre, persona.apellido1, persona.apellido2, persona.nombre, profesor.id_profesor from persona inner join profesor on persona.id = profesor.id_profesor left join departamento on profesor.id_departamento = departamento.id order by departamento.nombre, persona.apellido1, persona.apellido2, persona.nombre, profesor.id_profesor;
select persona.apellido1, persona.apellido2, persona.nombre, profesor.id_departamento from persona left join profesor on persona.id = profesor.id_profesor where profesor.id_departamento is null;
select departamento.nombre, profesor.id_profesor from departamento left join profesor on departamento.id = profesor.id_departamento where profesor.id_profesor is null;
select persona.apellido1, persona.apellido2, persona.nombre, asignatura.id_profesor from persona left join profesor on persona.id = profesor.id_profesor left join asignatura on profesor.id_profesor = asignatura.id_profesor where asignatura.id_profesor is null;
select asignatura.nombre, asignatura.creditos, asignatura.tipo, asignatura.curso, asignatura.cuatrimestre, grado.nombre from asignatura left join profesor on asignatura.id_profesor = profesor.id_profesor left join grado on asignatura.id_grado = grado.id where profesor.id_profesor is null;
-- select departamento.nombre from departamento left join profesor on departamento.id = profesor.id_departamento left join asignatura on profesor.id_profesor = asignatura.id_profesor left join curso_escolar on asignatura.id_asignatura = curso_escolar.id left join alumno_se_matricula_asignatura on curso_escolar.id = alumno_se_matricula_asignatura.id_curso_escolar where alumno_se_matricula_asignatura.id_asignatura is null;
select persona.apellido1, persona.apellido2, persona.nombre from persona where tipo = 'alumno';
select persona.apellido1, persona.apellido2, persona.nombre, persona.fecha_nacimiento from persona where tipo = 'alumno' and fecha_nacimiento between '1999-01-01' and '1999-12-31';
select departamento.nombre, count(distinct profesor.id_profesor) from departamento inner join profesor on departamento.id = profesor.id_departamento group by departamento.id order by profesor.id_departamento ASC;
select departamento.nombre, count(distinct profesor.id_profesor) from departamento left join profesor on departamento.id = profesor.id_departamento group by departamento.id;
select grado.nombre, count(distinct asignatura.id) AS numero_asignaturas from grado left join asignatura on asignatura.id_grado = grado.id group by grado.id order by numero_asignaturas DESC;
select grado.id, grado.nombre, count(distinct asignatura.id > 40) from grado inner join asignatura on grado.id = asignatura.id_grado group by grado.id;
select grado.nombre, asignatura.tipo, sum(distinct asignatura.creditos) as total_creditos from grado inner join asignatura on grado.id = asignatura.id_grado group by grado.id, asignatura.id order by grado.nombre, asignatura.tipo, total_creditos;
select curso_escolar.anyo_inicio, sum(distinct alumno_se_matricula_asignatura.id_alumno) as total_alumnos from curso_escolar inner join alumno_se_matricula_asignatura on alumno_se_matricula_asignatura.id_curso_escolar = curso_escolar.id group by curso_escolar.anyo_inicio;
select persona.id, persona.apellido1, persona.apellido2, persona.nombre, count(asignatura.id) as total_asignaturas_prof from persona inner join profesor on persona.id = profesor.id_profesor left join asignatura on asignatura.id_profesor = profesor.id_profesor group by persona.id, persona.apellido1, persona.apellido2, persona.nombre order by total_asignaturas_prof DESC;
select * from persona where tipo = 'alumno' order by fecha_nacimiento ASC;
